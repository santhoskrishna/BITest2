//HintName: RouteHandlerValidations.g.cs
// <auto-generated/>
#nullable enable
namespace System.Runtime.CompilerServices
{
    [AttributeUsage(System.AttributeTargets.Method, AllowMultiple = true)]
    file sealed class InterceptsLocationAttribute : Attribute
    {
        public InterceptsLocationAttribute(int version, string data) { }
    }
}

namespace Microsoft.AspNetCore.Http.Validations.Generated
{
    using System;
    using System.Linq;
    using System.Diagnostics;
    using System.ComponentModel.DataAnnotations;
    
    file class EndpointKey(string route, global::System.Collections.Generic.IEnumerable<string> methods)
    {
        public string Route { get; } = route;
        public global::System.Collections.Generic.IEnumerable<string> Methods { get; } = methods;
        
        public override bool Equals(object? obj)
        {
            if (obj is EndpointKey other)
            {
                return string.Equals(Route, other.Route, global::System.StringComparison.OrdinalIgnoreCase) &&
                Methods.SequenceEqual(other.Methods, global::System.StringComparer.OrdinalIgnoreCase);
            }
            return false;
        }
        
        public override int GetHashCode()
        {
            int hash = 17;
            hash = hash * 23 + (Route?.GetHashCode(global::System.StringComparison.OrdinalIgnoreCase) ?? 0);
            hash = hash * 23 + GetMethodsHashCode(Methods);
            return hash;
        }
        
        private static int GetMethodsHashCode(global::System.Collections.Generic.IEnumerable<string> methods)
        {
            if (methods == null)
            {
                return 0;
            }
            int hash = 17;
            foreach (var method in methods)
            {
                hash = hash * 23 + (method?.GetHashCode(global::System.StringComparison.OrdinalIgnoreCase) ?? 0);
            }
            return hash;
        }
    }

    file class ValidationProblemBuilder
    {
        private readonly global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails _problemDetails;
        
        public ValidationProblemBuilder()
        {
            _problemDetails = new global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails();
        }
        
        public ValidationProblemBuilder WithTitle(string title)
        {
            _problemDetails.Title = title;
            return this;
        }
        
        public ValidationProblemBuilder WithStatus(int? status)
        {
            _problemDetails.Status = status;
            return this;
        }
        
        public ValidationProblemBuilder WithDetail(string detail)
        {
            _problemDetails.Detail = detail;
            return this;
        }
        
        public ValidationProblemBuilder WithInstance(string instance)
        {
            _problemDetails.Instance = instance;
            return this;
        }
        
        public ValidationProblemBuilder WithType(string type)
        {
            _problemDetails.Type = type;
            return this;
        }
        
        public ValidationProblemBuilder WithExtensions(global::System.Collections.Generic.IDictionary<string, object> extensions)
        {
            foreach (var kvp in extensions)
            {
                _problemDetails.Extensions[kvp.Key] = kvp.Value;
            }
            return this;
        }
        
        public ValidationProblemBuilder WithErrors(global::System.Collections.Generic.IDictionary<string, string[]> errors)
        {
            foreach (var kvp in errors)
            {
                _problemDetails.Errors[kvp.Key] = kvp.Value;
            }
            return this;
        }
        
        public ValidationProblemBuilder WithError(string key, string error)
        {
            if (_problemDetails.Errors.ContainsKey(key))
            {
                _problemDetails.Errors[key] = _problemDetails.Errors[key].Append(error).ToArray();
            }
            else
            {
                _problemDetails.Errors[key] = new string[] { error };
            }
            return this;
        }
        
        public ValidationProblemBuilder WithErrors(string key, string[] errors)
        {
            if (_problemDetails.Errors.ContainsKey(key))
            {
                _problemDetails.Errors[key] = _problemDetails.Errors[key].Concat(errors).ToArray();
            }
            else
            {
                _problemDetails.Errors[key] = errors;
            }
            return this;
        }
        
        public global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails Build()
        {
            return _problemDetails;
        }
        
        public bool HasValue()
        {
            return _problemDetails.Errors.Count > 0;
        }
    }

    file static class WithValidationsInterceptor
    {
        [global::System.Runtime.CompilerServices.InterceptsLocationAttribute(1, "y289G4fCMnF0CWz59kYTt0gBAABQcm9ncmFtLmNz")]
        public static global::Microsoft.AspNetCore.Builder.IEndpointConventionBuilder WithValidation(this global::Microsoft.AspNetCore.Builder.IEndpointConventionBuilder builder)
        {
            System.Diagnostics.Debugger.Break();
            builder.AddEndpointFilter(async (context, next) =>
            {
                var targetEndpoint = context.HttpContext.Features.Get<global::Microsoft.AspNetCore.Http.Features.IEndpointFeature>()?.Endpoint;
                Debug.Assert(targetEndpoint != null);
                var route = ((global::Microsoft.AspNetCore.Routing.RouteEndpoint)targetEndpoint).RoutePattern.RawText;
                var methods = ((global::Microsoft.AspNetCore.Routing.RouteEndpoint)targetEndpoint).Metadata.GetMetadata<global::Microsoft.AspNetCore.Routing.IHttpMethodMetadata>()?.HttpMethods ?? ["GET"];
                Debug.Assert(route != null);
                var validationFilter = ValidationsFilters.Filters[new EndpointKey(route, methods)];
                var validationProblemDetails = validationFilter(context);
                if (validationProblemDetails == null)
                {
                    return await next(context);
                }
                return global::Microsoft.AspNetCore.Http.TypedResults.ValidationProblem(validationProblemDetails.Errors);
            });
            return builder;
        }
    }


    file static class ValidationTypes
    {
        public static global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails? Validate<T>(T value, global::System.ComponentModel.DataAnnotations.ValidationContext? validationContext = null, IServiceProvider? serviceProvider = null, int currentDepth = 0, bool skipRecurse = false) => null;
        
        private static readonly ValidationAttribute StringValue3Base64StringAttribute = new global::System.ComponentModel.DataAnnotations.Base64StringAttribute();
        
        public static global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails? Validate(DerivedType? value, global::System.ComponentModel.DataAnnotations.ValidationContext? validationContext = null, IServiceProvider? serviceProvider = null, int currentDepth = 0, bool skipRecurse = false)
        {
            var maxDepth = ((global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>)(serviceProvider ?? validationContext).GetService(typeof(global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>))).Value?.SerializerOptions.MaxDepth;
            if (currentDepth > (maxDepth == null || maxDepth == 0 ? 64 : maxDepth))
            {
                return null;
            }
            ValidationProblemBuilder resultBuilder = new();
            if (value != null)
            {
                if (value is BaseType subTypeBaseType)
                {
                    var subTypeBaseTypeValidationResult = ValidationTypes.Validate((BaseType)subTypeBaseType, validationContext, serviceProvider, currentDepth: currentDepth + 1, skipRecurse);
                    if (subTypeBaseTypeValidationResult is not null)
                    {
                        foreach (var error in subTypeBaseTypeValidationResult.Errors)
                        {
                            resultBuilder.WithErrors(error.Key, error.Value);
                        }
                    }
                }
                validationContext ??= new(value, serviceProvider: serviceProvider, items: null);
                validationContext.DisplayName = "Value3";
                validationContext.MemberName = "Value3";
                global::System.ComponentModel.DataAnnotations.ValidationResult? validationResult;
                validationResult = StringValue3Base64StringAttribute.GetValidationResult(value?.Value3, validationContext);
                if (validationResult is global::System.ComponentModel.DataAnnotations.ValidationResult { ErrorMessage: not null })
                {
                    resultBuilder.WithError("Value3", validationResult.ErrorMessage);
                }
            }
            return resultBuilder.HasValue() ? resultBuilder.Build() : null;
        }
        private static readonly ValidationAttribute Int32Value1RangeAttribute = new global::System.ComponentModel.DataAnnotations.RangeAttribute(10, 100);
        private static readonly ValidationAttribute StringValue2EmailAddressAttribute = new global::System.ComponentModel.DataAnnotations.EmailAddressAttribute();
        private static readonly ValidationAttribute StringValue2RequiredAttribute = new global::System.ComponentModel.DataAnnotations.RequiredAttribute();
        
        public static global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails? Validate(BaseType? value, global::System.ComponentModel.DataAnnotations.ValidationContext? validationContext = null, IServiceProvider? serviceProvider = null, int currentDepth = 0, bool skipRecurse = false)
        {
            var maxDepth = ((global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>)(serviceProvider ?? validationContext).GetService(typeof(global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>))).Value?.SerializerOptions.MaxDepth;
            if (currentDepth > (maxDepth == null || maxDepth == 0 ? 64 : maxDepth))
            {
                return null;
            }
            ValidationProblemBuilder resultBuilder = new();
            if (value != null)
            {
                if (!skipRecurse && value is DerivedType derivedTypeDerivedType)
                {
                    var derivedTypeDerivedTypeValidationResult = ValidationTypes.Validate(derivedTypeDerivedType, validationContext, serviceProvider, currentDepth: currentDepth + 1, skipRecurse: true);
                    if (derivedTypeDerivedTypeValidationResult is not null)
                    {
                        foreach (var error in derivedTypeDerivedTypeValidationResult.Errors)
                        {
                            resultBuilder.WithErrors(error.Key, error.Value);
                        }
                    }
                    return resultBuilder.HasValue() ? resultBuilder.Build() : null;
                }
                validationContext ??= new(value, serviceProvider: serviceProvider, items: null);
                validationContext.DisplayName = "Value 1";
                validationContext.MemberName = "Value1";
                global::System.ComponentModel.DataAnnotations.ValidationResult? validationResult;
                validationResult = Int32Value1RangeAttribute.GetValidationResult(value?.Value1, validationContext);
                if (validationResult is global::System.ComponentModel.DataAnnotations.ValidationResult { ErrorMessage: not null })
                {
                    resultBuilder.WithError("Value1", validationResult.ErrorMessage);
                }
                validationContext.DisplayName = "Value2";
                validationContext.MemberName = "Value2";
                validationResult = StringValue2EmailAddressAttribute.GetValidationResult(value?.Value2, validationContext);
                if (validationResult is global::System.ComponentModel.DataAnnotations.ValidationResult { ErrorMessage: not null })
                {
                    resultBuilder.WithError("Value2", validationResult.ErrorMessage);
                }
                validationResult = StringValue2RequiredAttribute.GetValidationResult(value?.Value2, validationContext);
                if (validationResult is global::System.ComponentModel.DataAnnotations.ValidationResult { ErrorMessage: not null })
                {
                    resultBuilder.WithError("Value2", validationResult.ErrorMessage);
                }
            }
            return resultBuilder.HasValue() ? resultBuilder.Build() : null;
        }
        private static readonly ValidationAttribute StringValue3EmailAddressAttribute = new global::System.ComponentModel.DataAnnotations.EmailAddressAttribute();
        
        public static global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails? Validate(DerivedValidatableType? value, global::System.ComponentModel.DataAnnotations.ValidationContext? validationContext = null, IServiceProvider? serviceProvider = null, int currentDepth = 0, bool skipRecurse = false)
        {
            var maxDepth = ((global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>)(serviceProvider ?? validationContext).GetService(typeof(global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>))).Value?.SerializerOptions.MaxDepth;
            if (currentDepth > (maxDepth == null || maxDepth == 0 ? 64 : maxDepth))
            {
                return null;
            }
            ValidationProblemBuilder resultBuilder = new();
            if (value != null)
            {
                if (value is BaseValidatableType subTypeBaseValidatableType)
                {
                    var subTypeBaseValidatableTypeValidationResult = ValidationTypes.Validate((BaseValidatableType)subTypeBaseValidatableType, validationContext, serviceProvider, currentDepth: currentDepth + 1, skipRecurse);
                    if (subTypeBaseValidatableTypeValidationResult is not null)
                    {
                        foreach (var error in subTypeBaseValidatableTypeValidationResult.Errors)
                        {
                            resultBuilder.WithErrors(error.Key, error.Value);
                        }
                    }
                }
                validationContext ??= new(value, serviceProvider: serviceProvider, items: null);
                validationContext.DisplayName = "Value3";
                validationContext.MemberName = "Value3";
                global::System.ComponentModel.DataAnnotations.ValidationResult? validationResult;
                validationResult = StringValue3EmailAddressAttribute.GetValidationResult(value?.Value3, validationContext);
                if (validationResult is global::System.ComponentModel.DataAnnotations.ValidationResult { ErrorMessage: not null })
                {
                    resultBuilder.WithError("Value3", validationResult.ErrorMessage);
                }
                if (!resultBuilder.HasValue())
                {
                    validationContext = new(value, serviceProvider: serviceProvider, items: null);
                    foreach (var validatableValidationResult in value.Validate(validationContext))
                    {
                        if (validatableValidationResult is global::System.ComponentModel.DataAnnotations.ValidationResult { ErrorMessage: not null })
                        {
                            resultBuilder.WithError(validatableValidationResult.MemberNames.FirstOrDefault() ?? "DerivedValidatableType", validatableValidationResult.ErrorMessage);
                        }
                    }
                }
            }
            return resultBuilder.HasValue() ? resultBuilder.Build() : null;
        }
        
        public static global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails? Validate(BaseValidatableType? value, global::System.ComponentModel.DataAnnotations.ValidationContext? validationContext = null, IServiceProvider? serviceProvider = null, int currentDepth = 0, bool skipRecurse = false)
        {
            var maxDepth = ((global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>)(serviceProvider ?? validationContext).GetService(typeof(global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>))).Value?.SerializerOptions.MaxDepth;
            if (currentDepth > (maxDepth == null || maxDepth == 0 ? 64 : maxDepth))
            {
                return null;
            }
            ValidationProblemBuilder resultBuilder = new();
            if (value != null)
            {
                if (!skipRecurse && value is DerivedValidatableType derivedTypeDerivedValidatableType)
                {
                    var derivedTypeDerivedValidatableTypeValidationResult = ValidationTypes.Validate(derivedTypeDerivedValidatableType, validationContext, serviceProvider, currentDepth: currentDepth + 1, skipRecurse: true);
                    if (derivedTypeDerivedValidatableTypeValidationResult is not null)
                    {
                        foreach (var error in derivedTypeDerivedValidatableTypeValidationResult.Errors)
                        {
                            resultBuilder.WithErrors(error.Key, error.Value);
                        }
                    }
                    return resultBuilder.HasValue() ? resultBuilder.Build() : null;
                }
                validationContext ??= new(value, serviceProvider: serviceProvider, items: null);
                validationContext.DisplayName = "Value 1";
                validationContext.MemberName = "Value1";
                if (!resultBuilder.HasValue())
                {
                    validationContext = new(value, serviceProvider: serviceProvider, items: null);
                    foreach (var validatableValidationResult in value.Validate(validationContext))
                    {
                        if (validatableValidationResult is global::System.ComponentModel.DataAnnotations.ValidationResult { ErrorMessage: not null })
                        {
                            resultBuilder.WithError(validatableValidationResult.MemberNames.FirstOrDefault() ?? "BaseValidatableType", validatableValidationResult.ErrorMessage);
                        }
                    }
                }
            }
            return resultBuilder.HasValue() ? resultBuilder.Build() : null;
        }
        
        public static global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails? Validate(ContainerType? value, global::System.ComponentModel.DataAnnotations.ValidationContext? validationContext = null, IServiceProvider? serviceProvider = null, int currentDepth = 0, bool skipRecurse = false)
        {
            var maxDepth = ((global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>)(serviceProvider ?? validationContext).GetService(typeof(global::Microsoft.Extensions.Options.IOptions<global::Microsoft.AspNetCore.Http.Json.JsonOptions>))).Value?.SerializerOptions.MaxDepth;
            if (currentDepth > (maxDepth == null || maxDepth == 0 ? 64 : maxDepth))
            {
                return null;
            }
            ValidationProblemBuilder resultBuilder = new();
            if (value != null)
            {
                validationContext ??= new(value, serviceProvider: serviceProvider, items: null);
                validationContext.DisplayName = "BaseType";
                validationContext.MemberName = "BaseType";
                var typeBaseTypeValidationResult = ValidationTypes.Validate(value?.BaseType, validationContext, serviceProvider, currentDepth: currentDepth + 1, skipRecurse);
                if (typeBaseTypeValidationResult is not null)
                {
                    foreach (var error in typeBaseTypeValidationResult.Errors)
                    {
                        resultBuilder.WithErrors($"BaseType.{error.Key}", error.Value);
                    }
                }
                validationContext.DisplayName = "BaseValidatableType";
                validationContext.MemberName = "BaseValidatableType";
                var typeBaseValidatableTypeValidationResult = ValidationTypes.Validate(value?.BaseValidatableType, validationContext, serviceProvider, currentDepth: currentDepth + 1, skipRecurse);
                if (typeBaseValidatableTypeValidationResult is not null)
                {
                    foreach (var error in typeBaseValidatableTypeValidationResult.Errors)
                    {
                        resultBuilder.WithErrors($"BaseValidatableType.{error.Key}", error.Value);
                    }
                }
            }
            return resultBuilder.HasValue() ? resultBuilder.Build() : null;
        }
    }


    file static class ValidationsFilters
    {
        public static readonly global::System.Collections.Generic.Dictionary<EndpointKey, global::System.Func<global::Microsoft.AspNetCore.Http.EndpointFilterInvocationContext, global::Microsoft.AspNetCore.Http.HttpValidationProblemDetails?>> Filters = new()
        {
            { new EndpointKey("/basic-polymorphism", ["POST"]), context => 
                {
                    ValidationProblemBuilder resultBuilder = new();
                    var value0 = context.GetArgument<BaseType>(0);
                    var typeValidationResult = ValidationTypes.Validate(value0, serviceProvider: context.HttpContext.RequestServices);
                    if (typeValidationResult is not null)
                    {
                        foreach (var error in typeValidationResult.Errors)
                        {
                            resultBuilder.WithErrors(error.Key, error.Value);
                        }
                    }
                    return resultBuilder.HasValue() ? resultBuilder.Build() : null;
                }
            },

            { new EndpointKey("/validatable-polymorphism", ["POST"]), context => 
                {
                    ValidationProblemBuilder resultBuilder = new();
                    var value0 = context.GetArgument<BaseValidatableType>(0);
                    var typeValidationResult = ValidationTypes.Validate(value0, serviceProvider: context.HttpContext.RequestServices);
                    if (typeValidationResult is not null)
                    {
                        foreach (var error in typeValidationResult.Errors)
                        {
                            resultBuilder.WithErrors(error.Key, error.Value);
                        }
                    }
                    return resultBuilder.HasValue() ? resultBuilder.Build() : null;
                }
            },

            { new EndpointKey("/polymorphism-container", ["POST"]), context => 
                {
                    ValidationProblemBuilder resultBuilder = new();
                    var value0 = context.GetArgument<ContainerType>(0);
                    var typeValidationResult = ValidationTypes.Validate(value0, serviceProvider: context.HttpContext.RequestServices);
                    if (typeValidationResult is not null)
                    {
                        foreach (var error in typeValidationResult.Errors)
                        {
                            resultBuilder.WithErrors(error.Key, error.Value);
                        }
                    }
                    return resultBuilder.HasValue() ? resultBuilder.Build() : null;
                }
            },

        };
    }
}
#nullable restore
